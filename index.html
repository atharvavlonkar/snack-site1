<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>School Snack Shop</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body { font-family: Arial, sans-serif; background:#f2f2f2; padding:20px; }
h1,h2 { text-align:center; }
.box { background:white; max-width:750px; margin:auto; padding:15px; border-radius:8px; margin-bottom:20px; }
.product,.cart-item,.admin-row { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
button { padding:6px 10px; }
.out { color:red; font-weight:bold; }
input,textarea { width:100%; padding:6px; margin-bottom:8px; }
.hidden { display:none; }
.small { font-size:12px; color:#555; }
</style>
</head>

<body>

<h1>School Snack Shop</h1>

<div class="box">
<h2>Menu</h2>
<div id="productList"></div>
</div>

<div class="box">
<h2>Cart</h2>
<div id="cartItems">Cart is empty</div>
<p><strong>Total: $<span id="total">0.00</span></strong></p>
</div>

<div class="box">
<h2>Checkout</h2>
<input type="email" id="email" placeholder="Your email" required>
<input type="text" placeholder="Day you want to buy">
<input type="time">
<textarea placeholder="Notes (optional)"></textarea>
<button onclick="checkout()">Place Order</button>
<p id="status"></p>
</div>

<div class="box">
<h2>Admin Panel</h2>
<input type="password" id="adminPass" placeholder="Admin password">
<button onclick="unlockAdmin()">Unlock</button>
<div id="adminPanel" class="hidden"></div>
<p class="small">Admin password: <b>1234</b> (change in code)</p>
</div>

<script>
const ADMIN_PASSWORD = "9813";

const prices = {
  "Takis": 1.00,
  "Gatorade Red": 1.50,
  "Gatorade Orange": 1.50,
  "Gatorade Green": 1.50,
  "Gum Polar Ice": 0.20,
  "Gum Peppermint": 0.20
};

let stock = JSON.parse(localStorage.getItem("stock")) || {
  "Takis": 20,
  "Gatorade Red": 15,
  "Gatorade Orange": 15,
  "Gatorade Green": 15,
  "Gum Polar Ice": 30,
  "Gum Peppermint": 30
};

let cart = {};

saveStock();
renderProducts();

function saveStock() {
  localStorage.setItem("stock", JSON.stringify(stock));
}

function renderProducts() {
  const list = document.getElementById("productList");
  list.innerHTML = "";

  for (let item in prices) {
    const s = stock[item];
    const div = document.createElement("div");
    div.className = "product";

    if (s <= 0) {
      div.innerHTML = `<span>${item} - $${prices[item].toFixed(2)}</span>
                       <span class="out">OUT OF STOCK</span>`;
    } else {
      div.innerHTML = `<span>${item} - $${prices[item].toFixed(2)} (Stock: ${s})</span>
                       <button onclick="addToCart('${item}')">Add</button>`;
    }
    list.appendChild(div);
  }
}

function addToCart(item) {
  if (stock[item] <= 0) return;
  cart[item] = (cart[item] || 0) + 1;
  stock[item]--;
  saveStock();
  renderProducts();
  renderCart();
}

function removeFromCart(item) {
  cart[item]--;
  stock[item]++;
  if (cart[item] <= 0) delete cart[item];
  saveStock();
  renderProducts();
  renderCart();
}

function renderCart() {
  const div = document.getElementById("cartItems");
  div.innerHTML = "";
  let total = 0;

  for (let item in cart) {
    total += cart[item] * prices[item];
    div.innerHTML += `<div class="cart-item">
      <span>${item} x${cart[item]}</span>
      <button onclick="removeFromCart('${item}')">Remove</button>
    </div>`;
  }

  if (!Object.keys(cart).length) div.innerHTML = "Cart is empty";
  document.getElementById("total").innerText = total.toFixed(2);
}

function checkout() {
  if (!email.value) return alert("Email required");
  document.getElementById("status").innerText =
    "Order placed! Screenshot this confirmation.";
  cart = {};
  renderCart();
}

function unlockAdmin() {
  if (document.getElementById("adminPass").value !== ADMIN_PASSWORD) {
    alert("Wrong password");
    return;
  }

  const panel = document.getElementById("adminPanel");
  panel.classList.remove("hidden");
  panel.innerHTML = "";

  for (let item in stock) {
    panel.innerHTML += `<div class="admin-row">
      <span>${item}</span>
      <input type="number" value="${stock[item]}" min="0"
        onchange="updateStock('${item}', this.value)">
    </div>`;
  }
}

function updateStock(item, value) {
  stock[item] = parseInt(value) || 0;
  saveStock();
  renderProducts();
}
</script>

</body>
</html>

